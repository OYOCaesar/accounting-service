<!DOCTYPE HTML>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org" >
<head>
    <meta charset="UTF-8">
    <title>文件上传</title>
    <link rel="stylesheet" type="text/css"
          href="easyui/themes/default/easyui.css">
    <link rel="stylesheet" type="text/css" href="./easyui/themes/icon.css">
    <link rel="stylesheet" type="text/css" href="./easyui/demo/demo.css">
    <script src="./js/jquery-1.7.2.js"></script>
    <script type="text/javascript" src="./easyui/jquery.easyui.min.js"></script>

    <style>
        .importData_div{
            margin-bottom: 20px;
        }
        .importData_div form{
            margin-left: 25px;
        }
        .search_div div{
            height: 30px;
            margin-left:25px;
        }
        .search_div input{
            width:135px;
        }
        .search_div .input,a{
            margin-left: 20px;
        }
        .search_div .input span{
            width:80px;
            align-content: right;
        }
    </style>
</head>
<body>
<div class="importData_div">
    <h4>导入数据</h4>
    <form name="uploadFileForm" action="/fileUpload/upload" method="post"  enctype="multipart/form-data" onsubmit="return check();">
        <div style="margin-left: 15px;margin-bottom: 10px;">
            <span style="font-size:14px;">数据的类型：</span><select id="is_test_select" name ="isTest"><option value="f">真实数据</option><option value="t">测试数据</option> </select>
            <span style="margin-left: 30px;">
                <input id="file_input" height="30" type="file" name="file">
                <input height="30" type="submit" value="上传"/>
            </span>
        </div>
    </form>
</div>
<hr/>
<div class="search_div">
    <h4>查询</h4>
    <div>
        <span class="input"><span>hotelId: </span><input class="easyui-textbox" value="" id="hotelId_inp" data-options="iconCls:'icon-search'"></span>
        <span class="input"><span>oyoId: </span><input class="easyui-textbox" value="" id="oyoId_inp" data-options="iconCls:'icon-search'"></span>
        <span class="input">hotelName: </span><input class="easyui-textbox" value="" id="hotelName_inp" data-options="iconCls:'icon-search'"></span>
        <span class="input"><span>status: </span><input class="easyui-textbox" value="" id="status_inp" data-options="iconCls:'icon-undo'"></span>
    </div>
    <div>
        <span class="input"><span>数据类型: </span><input id="isTest_inp" class="easyui-combobox" data-options="valueField:'id',textField:'text',data:[{id:'f',text:'真实数据'},{id:'t',text:'测试数据'}]"></span>
        <span class="input"><span>上传时间: </span><input id="batch_inp" class="easyui-combobox" data-options=""></span>
        <a id="search_btn" href="javascript:void(0);" class="easyui-linkbutton" data-options="iconCls:'icon-search'">查询</a>
        &nbsp;&nbsp;
        <a id="reset_btn" href="javascript:void(0);" class="easyui-linkbutton" data-options="iconCls:'icon-search'">重置</a>
   </div>
</div>
<div id="oyo_share_list">  </div>
<h2 th:text="${data}"/>
<script>

    $(function () {

        loadBatchData();

        queryOyoShareList();

        $('#search_btn').bind('click', function(){
            var queryParams = getOyoShareListQueryParams();
            $('#oyo_share_list').datagrid('load',queryParams);
        });

        $('#reset_btn').bind('click', function(){
            $('#hotelId_inp').attr('value','');
            $('#oyoId_inp').attr('value','');
            $('#hotelName_inp').attr("value",'');
            $('#status_inp').attr("value",'');
            $('#isTest_inp').combobox("setValue",'');
            $('#batch_inp').combobox("setValue",'');
        });
    });

    function loadBatchData() {
        $('#batch_inp').combobox({
            url:'/oyoShare/queryBatchData',
            valueField:'batch',
            textField:'batch'
        });
    }

    function check(){
        var ele = document.getElementById('file_input');
        if(ele.value == null || ele.value == undefined || ele.value == ''){
            alert("请选择一个文件！");
            return false;
        }else{
            return true;
        }
    }

    function queryOyoShareList() {

        var queryParams = getOyoShareListQueryParams();

        $('#oyo_share_list').datagrid({
            url:'oyoShare/oyoShareList',
            columns:[[
                {field:'id',title:'id',width:60},
                {field:'hotelId',title:'hotelId',width:60},
                {field:'uniqueCode',title:'uniqueCode',width:60},
                {field:'oyoId',title:'oyoId',width:100},
                {field:'hotelName',title:'hotelName',width:252},
                {field:'city',title:'city',width:100},
                {field:'zoneName',title:'zoneName',width:160},
                {field:'fixedRate',title:'fixedRate',width:80},
                {field:'status',title:'status',width:60},
                {field:'oyoShare',title:'oyoShare',width:60}
            ]],
            rownumbers:true,
            queryParams: queryParams
        });
    }

    function getOyoShareListQueryParams() {
        var hotelId = $('#hotelId_inp').attr('value').trim();
        var oyoId = $('#oyoId_inp').attr('value').trim();
        var hotelName = $('#hotelName_inp').attr("value").trim();
        var status = $('#status_inp').attr("value").trim();
        var isTest = $('#isTest_inp').combobox("getValue");
        var batch = $('#batch_inp').combobox("getValue");

        var queryParams = {
            hotelId: hotelId,
            oyoId: oyoId,
            hotelName: hotelName,
            status: status,
            isTest:isTest,
            batch:batch
        };
        return queryParams;
    }

</script>
</body>
</html>