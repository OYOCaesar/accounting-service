<!DOCTYPE HTML>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org" >
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>Munshi cr and cp list</title>
    <link rel="stylesheet" type="text/css" href="./easyui/themes/default/easyui.css">
    <link rel="stylesheet" type="text/css" href="./easyui/themes/icon.css">
    <link rel="stylesheet" type="text/css" href="./easyui/demo/demo.css">
    <script type="text/javascript" src="./js/jquery-1.7.2.js"></script>
    <script type="text/javascript" src="./easyui/jquery.easyui.min.js"></script>
    <script type="text/javascript" src="./laydate/laydate.js"></script>
</head>
<body>
<table style="border:none;width:98%;">
    <tr>
        <td align="left">Year Month: </td>
        <td>
            <input id="yearMonth" name="yearMonth"/>
        </td>
        <td>hotelName:</td>
        <td>
            <input class="easyui-textbox" value="" id="hotelName" name="hotelName" data-options="iconCls:'icon-search'" style="width:300px;">
        </td>
        <td>isSync:</td>
        <td>
            <select id="isSync" class="easyui-combobox" name="isSync" style="width:80px;">
		        <option value="" selected="selected">--All--</option>
			    <option value="1">true</option>
			    <option value="0">false</option>
		    </select>
            &nbsp;
		    <a id="search_btn" href="javascript:void(0);" class="easyui-linkbutton" data-options="iconCls:'icon-search'">查询</a>
		    <a id="reset_btn" href="javascript:void(0);" class="easyui-linkbutton" data-options="iconCls:'icon-undo'">重置</a>
		    <a id="search_badk" href="index.html" class="easyui-linkbutton" data-options="iconCls:'icon-back'">返回</a>
        </td>
    </tr>
</table>
<br/>
<div id="munshi_ar_ap_list"></div><br/>
<script>

	//执行一个laydate实例
	laydate.render({
	    elem: '#yearMonth' //指定元素
	    ,type: 'month'
	});

    $(function () {
    	//补零函数
    	function prefixInteger(num, n) {
           return (Array(n).join(0) + num).slice(-n);
        }
    	
    	var myDate = new Date();
    	//获取当前年
    	var year=myDate.getFullYear();
    	//获取当前月
    	var month=myDate.getMonth()+1;
    	month = prefixInteger(month,2);
    	
    	var lastMonthDate = new Date(myDate.getFullYear(),myDate.getMonth()-1,myDate.getDate());//上个月
    	var lastYear = lastMonthDate.getFullYear();
    	var lastMonth = lastMonthDate.getMonth()+1;
    	lastMonth = prefixInteger(lastMonth,2);
    	
    	$("#yearMonth").val(lastYear + "-" + lastMonth);
    	
    	queryMunshiArAndAPList();
    	
        $('#search_btn').bind('click', function(){
        	queryMunshiArAndAPList();
        });

        $('#reset_btn').bind('click', function(){
            $('#yearMonth').attr('value','');
            $('#hotelName').attr('value','');
            $('#isSync').combobox('setValue','');
        });
    });

    function queryMunshiArAndAPList() {
    	var yearMonth = $('#yearMonth').val().trim();
    	var hotelName = $('#hotelName').val().trim();
    	var isSync = $('#isSync').combo('getValue');
    	
    	var queryParams = {
    	    yearMonth: yearMonth,
    	    hotelName: hotelName,
    	    isSync:isSync
        }

        var grid = $('#munshi_ar_ap_list').datagrid({
            url:'queryMunshiArAp/query',
            columns:[[
                {field:'hotelId',title:'hotel id',width:60,sortable:true},
                {field:'hotelName',title:'hotel name',sortable:true},
                {field:'arAmount',title:'ar Amount',width:80,sortable:true},
                {field:'apAmount',title:'ap Amount',width:80},
                {field:'rate',title:'rate',width:60},
                {field:'isSync',title:'isSync',width:60}
            ]],
            loadMsg : '正在加载数据，请稍后...',
            fitColumns:true,
            rownumbers:true,
            pagination: true,
            striped:true,
            sortName:'hotelId',
            sortOrder:'asc',
            pageNumber:1, //第几页显示（默认第一页，可以省略）
            pageSize: 10, //分页大小  
            pageList: [10,20,50,100,200,500,1000],
            queryParams: queryParams
        });

    }
    
    function myformatter(date){
		var y = date.getFullYear();
		var m = date.getMonth()+1;
		var d = date.getDate();
		return y+'-'+(m<10?('0'+m):m)+'-'+(d<10?('0'+d):d);
	}
	function myparser(s){
		if (!s) return new Date();
		var ss = (s.split('-'));
		var y = parseInt(ss[0],10);
		var m = parseInt(ss[1],10);
		var d = parseInt(ss[2],10);
		if (!isNaN(y) && !isNaN(m) && !isNaN(d)){
			return new Date(y,m-1,d);
		} else {
			return new Date();
		}
	}

</script>
</body>
</html>